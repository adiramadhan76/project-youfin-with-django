{% extends 'page/base.html' %}
{% load static %}

{% block title %}Tambah Transaksi{% endblock %}

{% block your_content_here %}
<div class="overlap">
    <div class="content-card">
        <h1><i class="bi bi-cash-stack" style="margin-right: 4px;"></i> Tambah Transaksi</h1>

        <form method="POST">
            {% csrf_token %}
            <div class="form-group">
                <label class="my-3" for="name">Nama Transaksi</label>
                <input type="text" name="name" id="name" class="form-control" placeholder="Masukan nama transaksi" autocomplete="off" autofocus required>
            </div>
            <div class="form-group">
                <label class="my-3" for="category">Kategori</label>
                <select name="category" id="category" class="form-control" required>
                    <option value="" data-type="">- Pilih Kategori -</option>
                    {% for category in categories %}
                        <option value="{{ category.id }}" data-type="{{ category.category_type }}">{{ category.name }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="form-group">
                <label class="my-3" for="transaction_type">Jenis Transaksi</label>
                <input type="text" placeholder="Jenis transaksi akan otomatis terisi berdasarkan kategori yang dipilih" name="transaction_type" id="transaction_type" class="form-control" readonly>
            </div>
            <div class="form-group">
                <label class="my-3" for="amount">Nominal</label>
                <input type="number" min="0" autocomplete="off" name="amount" id="amount" class="form-control" placeholder="Masukan nominal transaksi" required>
            </div>
            <div class="form-group">
                <label class="my-3" for="date">Tanggal</label>
                <input type="date" name="date" id="date" class="form-control mb-3" required>
            </div>
            <button type="submit" class="btn btn-success">Tambah Transaksi</button>
            <a href="{% url 'youfin_app:transaksi' %}" class="btn btn-secondary">Batal</a>
        </form>
    </div>
</div>
{% endblock %}

{% block script_transaksi %}
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const categorySelect = document.getElementById("category");
        const transactionTypeInput = document.getElementById("transaction_type");

        // Function to update the transaction type based on selected category
        function updateTransactionType() {
            const selectedOption = categorySelect.options[categorySelect.selectedIndex];
            if (selectedOption) {
                const transactionType = selectedOption.getAttribute("data-type"); // Get data-type attribute from option
                transactionTypeInput.value = transactionType || ""; // Set input value or empty string
            }
        }

        // Initial update when the page loads
        updateTransactionType();

        // Event listener to update transaction type when category changes
        categorySelect.addEventListener("change", updateTransactionType);
    });
</script>
{% endblock %}
